import React,{useState} from 'react';import {View,TextInput,TouchableOpacity,Text,StyleSheet,ActivityIndicator,SafeAreaView,KeyboardAvoidingView,Platform,ScrollView} from 'react-native';import axios from 'axios';import {API_ENDPOINTS,getApiHeaders} from './api';export default function SendOTPScreen({navigation}){const[mobileNumber,setMobileNumber]=useState('');const[loading,setLoading]=useState(false);const[error,setError]=useState('');const validateMobileNumber=(number)=>{const regex=/^[6-9]\d{9}$/;return regex.test(number);};const handleSendOTP=async()=>{setError('');if(!mobileNumber.trim()){setError('Enter mobile number');return;}if(!validateMobileNumber(mobileNumber)){setError('Enter valid 10-digit number');return;}setLoading(true);try{await axios.post(API_ENDPOINTS.SEND_OTP,{mobile:mobileNumber},{headers:getApiHeaders()});navigation.navigate('VerifyOTP',{mobileNumber});}catch(err){setError('Failed to send OTP');}finally{setLoading(false);}};return <SafeAreaView style={styles.container}><KeyboardAvoidingView behavior={Platform.OS==='ios'?'padding':'height'} style={styles.flex}><ScrollView contentContainerStyle={styles.content}><View style={styles.header}><Text style={styles.icon}>ðŸ“±</Text><Text style={styles.title}>StapuBox</Text><Text style={styles.subtitle}>Sign Up</Text></View><View style={styles.form}><Text style={styles.label}>Mobile</Text><View style={[styles.inputBox,error&&styles.inputError]}><Text style={styles.code}>+91</Text><TextInput style={styles.input} placeholder="9876543210" placeholderTextColor="#999" keyboardType="phone-pad" maxLength={10} value={mobileNumber} onChangeText={(text)=>{setMobileNumber(text);if(error)setError('');}} editable={!loading}/></View>{error&&<Text style={styles.errorText}>{error}</Text>}</View><TouchableOpacity style={[(loading||!mobileNumber)?styles.buttonDisabled:styles.button]} onPress={handleSendOTP} disabled={loading||!mobileNumber}>{loading?<ActivityIndicator color="#fff"/>:<Text style={styles.buttonText}>Send OTP</Text>}</TouchableOpacity><Text style={styles.info}>4-digit code via SMS</Text></ScrollView></KeyboardAvoidingView></SafeAreaView>;} const styles=StyleSheet.create({container:{flex:1,backgroundColor:'#fff'},flex:{flex:1},content:{flexGrow:1,padding:20,justifyContent:'space-between'},header:{alignItems:'center',marginBottom:40,marginTop:20},icon:{fontSize:60,marginBottom:15},title:{fontSize:28,fontWeight:'700',color:'#1a1a1a',marginBottom:5},subtitle:{fontSize:14,color:'#666'},form:{marginBottom:30},label:{fontSize:13,fontWeight:'600',color:'#333',marginBottom:10},inputBox:{flexDirection:'row',alignItems:'center',height:50,borderWidth:1,borderColor:'#ddd',borderRadius:10,paddingHorizontal:12,marginBottom:8},inputError:{borderColor:'#ff6b6b',backgroundColor:'#fff5f5'},code:{fontSize:16,fontWeight:'600',color:'#1a1a1a',marginRight:8},input:{flex:1,fontSize:16,color:'#1a1a1a'},errorText:{color:'#ff6b6b',fontSize:12,marginTop:6},button:{height:50,backgroundColor:'#007AFF',borderRadius:10,justifyContent:'center',alignItems:'center',marginBottom:20},buttonDisabled:{height:50,backgroundColor:'#ccc',borderRadius:10,justifyContent:'center',alignItems:'center',marginBottom:20},buttonText:{color:'#fff',fontSize:16,fontWeight:'600'},info:{textAlign:'center',color:'#999',fontSize:12}});
